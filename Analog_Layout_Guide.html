<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Analog Layout Guide | TVIP Analog Workspace</title>
    <meta name="description" content="Analog Design Workspace for Sky130 PDK">
    <meta name="generator" content="VitePress v1.3.4">
    <link rel="preload stylesheet" href="/tvip-analog-workspace/assets/style.BW1oSJsW.css" as="style">
    
    <script type="module" src="/tvip-analog-workspace/assets/app.pnVk7tm_.js"></script>
    <link rel="preload" href="/tvip-analog-workspace/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/tvip-analog-workspace/assets/chunks/theme.D5CjjV64.js">
    <link rel="modulepreload" href="/tvip-analog-workspace/assets/chunks/framework.SW3b9r8z.js">
    <link rel="modulepreload" href="/tvip-analog-workspace/assets/Analog_Layout_Guide.md.MfPhWJ-m.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-ab179fa1><a class="title" href="/tvip-analog-workspace/" data-v-ab179fa1><!--[--><!--]--><!----><span data-v-ab179fa1>TVIP Analog Workspace</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/tvip-analog-workspace/" tabindex="0" data-v-dc692963 data-v-9c663999><!--[--><span data-v-9c663999>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/tvip-analog-workspace/Analog_Layout_Guide.html" tabindex="0" data-v-dc692963 data-v-9c663999><!--[--><span data-v-9c663999>Analog Layout Guide</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/tvip-analog-workspace/Power_Grids.html" tabindex="0" data-v-dc692963 data-v-9c663999><!--[--><span data-v-9c663999>Power Grids</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6aa21345 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/neu-ucb-tvip/tvip-analog-workspace" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-b6c34ac9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-b6c34ac9><span class="vpi-more-horizontal icon" data-v-b6c34ac9></span></button><div class="menu" data-v-b6c34ac9><div class="VPMenu" data-v-b6c34ac9 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/neu-ucb-tvip/tvip-analog-workspace" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-17a5e62e><button data-v-17a5e62e>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 has-active" data-v-c40bc020 data-v-b7550ba0><div class="item" role="button" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><h2 class="text" data-v-b7550ba0>Documentation</h2><!----></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/tvip-analog-workspace/Analog_Layout_Guide.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Analog Layout Guide</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/tvip-analog-workspace/Power_Grids.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Power Grids</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>On this page</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _tvip-analog-workspace_Analog_Layout_Guide" data-v-39a288b8><div><h1 id="analog-layout-guide" tabindex="-1">Analog Layout Guide <a class="header-anchor" href="#analog-layout-guide" aria-label="Permalink to &quot;Analog Layout Guide&quot;">​</a></h1><h2 id="best-references" tabindex="-1">Best references <a class="header-anchor" href="#best-references" aria-label="Permalink to &quot;Best references&quot;">​</a></h2><h3 id="core-layout-and-packaging" tabindex="-1">Core layout and packaging <a class="header-anchor" href="#core-layout-and-packaging" aria-label="Permalink to &quot;Core layout and packaging&quot;">​</a></h3><p><a href="./Razavi_Analog_CMOS_-_Ch.19_Layout_and_Packaging.pdf">Razavi Analog CMOS - Ch.19 Layout and Packaging</a></p><p>Topics covered by Razavi Ch.19:</p><ul><li>Analog layout techniques and best practices</li><li>Current mirror layout and matching considerations</li><li>Passive device layout (resistors, capacitors)</li><li>Interconnect design and crosstalk reduction</li><li>Device matching techniques</li><li>Layout for high-precision circuits</li><li>Common layout pitfalls and solutions</li></ul><h3 id="layout-and-matching" tabindex="-1">Layout and matching <a class="header-anchor" href="#layout-and-matching" aria-label="Permalink to &quot;Layout and matching&quot;">​</a></h3><p>Ali Niknejad Spring 2021 EE 194/290C Lecture series:</p><ul><li><a href="./resources/Niknejad_290C_Lecture-1-Virtuoso_Intro.pdf">Lecture 1 - Virtuoso Introduction</a></li><li><a href="./resources/Niknejad_290C_Lecture-2-Layout.pdf">Lecture 2 - Layout</a></li><li><a href="./resources/Niknejad_290C_Lecture-3-Matching.pdf">Lecture 3 - Matching</a></li></ul><p><a href="./resources/Maloberti_Layout_of_Analog_CMOS_ICs.pdf">Maloberti Layout of Analog CMOS ICs</a></p><p><a href="./Lienig_Fundamentals_of_Layout_Design_for_Electronic_Circuits.pdf">Lienig, Scheible, &quot;Fundamentals of Layout Design for Electronic Circuits,&quot; Springer 2020</a></p><h3 id="passive-component-layout" tabindex="-1">Passive component layout <a class="header-anchor" href="#passive-component-layout" aria-label="Permalink to &quot;Passive component layout&quot;">​</a></h3><ul><li><a href="./resources/Niknejad_242B_Module_1_3_Passives-2.pdf">Niknejad 242B Module 1.3 - Passives</a></li><li><a href="./resources/Chien_240B_lec3_passives.pdf">Chien 240B Lecture 3 - Passives</a></li></ul><h2 id="substrate-and-body-contacts" tabindex="-1">Substrate and body contacts <a class="header-anchor" href="#substrate-and-body-contacts" aria-label="Permalink to &quot;Substrate and body contacts&quot;">​</a></h2><p>In both planar MOSFETs and FinFETs, we are often guilty of thinking of them as three-terminal devices (gate, drain, and source) because those are the terminals we actively drive.</p><p>However, these transistors are truly four-terminal devices: gate, drain, source, and body/substrate. The body (or bulk) terminal is for setting the device&#39;s operating point and ensuring proper isolation and biasing in an integrated circuit.</p><p>In a schematic, the body node is typically drawn as a separate terminal on the MOS symbol. But in the actual layout, this same body (or bulk) connection appears as substrate contacts, &quot;taps,&quot; or tap cells:</p><img src="/tvip-analog-workspace/assets/planar_body_contact.gxmIdC5G.png" alt="planar body contact" width="400px"><p>In many simpler or smaller analog layouts, you might place substrate taps on either side of your active device. This provides two direct pathways to the substrate, ensuring reasonably low-resistance paths from the device body to ground (for NMOS) or to VDD (for PMOS).</p><img src="/tvip-analog-workspace/assets/planar_double_sided_body_contact.DCQKkGpU.png" alt="planar double sided body contact" width="400px"><h3 id="guard-rings" tabindex="-1">Guard rings <a class="header-anchor" href="#guard-rings" aria-label="Permalink to &quot;Guard rings&quot;">​</a></h3><p>Instead of just placing body contacts on the left and right (or top and bottom), you can create a continuous &quot;ring&quot; or guard structure of substrate contacts around the device. This is often referred to as a <strong>guard ring</strong> when it fully encircles the transistor or transistor array.</p><img src="/tvip-analog-workspace/assets/planar_guard_ring.Ypw5gfvZ.png" alt="planar guard ring" width="400px"><p>The ring can act like a shield that helps keep substrate noise out (or in). In sensitive analog circuits, this can be very important for performance.</p><p>Fully surrounding devices with taps can reduce latch-up risk by providing abundant substrate tie points.</p><ul><li><strong>In the Intel 16 process, it is MANDATORY that any device which connects to a bump be enclosed by a guard ring.</strong></li></ul><p>Another benefit, for PMOS devices and deep NWELL NMOS, is that the entire perimeter of the device is tied to the desired well potential which will minimize uneven substrate gradients.</p><h2 id="layout-matching" tabindex="-1">Layout matching <a class="header-anchor" href="#layout-matching" aria-label="Permalink to &quot;Layout matching&quot;">​</a></h2><p>When designing analog circuits, the geometry and arrangement of devices determine parasitic resistances, capacitances, device mismatches, and noise coupling. Although schematic simulations capture many effects, physical layout contributes additional variations that are not always obvious until tapeout.</p><p>Below is an overview of key concepts and best practices.</p><h3 id="systematic-vs-random-mismatch" tabindex="-1">Systematic vs random mismatch <a class="header-anchor" href="#systematic-vs-random-mismatch" aria-label="Permalink to &quot;Systematic vs random mismatch&quot;">​</a></h3><img src="/tvip-analog-workspace/assets/asymmetric_mosfet.BYpZtSL4.png" alt="asymmetric mosfet" width="600px"><p>Image from <a href="./resources/Maloberti_Layout_of_Analog_CMOS_ICs.pdf">F. Maloberti, &quot;Layout of Analog CMOS Integrated Circuits&quot; (Part 2)</a>. This is an example of a <strong>systematic mismatch</strong> due fabrication, where the wafer is intentionally tilted by ~7 degrees to prevent channeling of implanted ions. This creates shadowing and mismatch in source/drain doping.</p><p>In analog layouts, mismatch is often categorized as:</p><p><strong>Systematic (layout-induced) offset</strong>: Caused by non-identical device surroundings, metal routing differences, or doping variations due to implants hitting the wafer at slight angles. Careful layout can greatly reduce these systematic offsets (for example, by using symmetrical placement and consistent routing).</p><p><strong>Random (local) mismatch</strong>: Arises from fundamental process variations in doping and line-edge roughness. Each transistor, resistor, or capacitor on the same die can differ slightly in parameters like <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.339ex;" xmlns="http://www.w3.org/2000/svg" width="4.054ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1791.7 833" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z" style="stroke-width:3;"></path></g><g data-mml-node="TeXAtom" transform="translate(616,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(704,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>V</mi><mrow data-mjx-texclass="ORD"><mi>T</mi><mi>H</mi></mrow></msub></math></mjx-assistive-mml></mjx-container> or sheet resistance.</p><p><strong>Systematic mismatch can be mitigated with symmetry and common-centroid techniques.</strong></p><p><strong>Random mismatch is improved by using larger device sizes or arrays of parallel &quot;unit cells.&quot;</strong></p><blockquote><p><strong>Rule of thumb</strong>: Matching devices should always be placed as close as possible to each other in the layout. The smaller the layout distance, the less unknown gradients—regardless of what causes them and their magnitude—can contribute to a mismatch.</p><p>From <a href="./Lienig_Fundamentals_of_Layout_Design_for_Electronic_Circuits.pdf">Lienig, Scheible, &quot;Fundamentals of Layout Design for Electronic Circuits,&quot; Springer 2020</a>. Page 248.</p></blockquote><h3 id="common-centroid-and-interdigitation" tabindex="-1">Common-centroid and interdigitation <a class="header-anchor" href="#common-centroid-and-interdigitation" aria-label="Permalink to &quot;Common-centroid and interdigitation&quot;">​</a></h3><p>Common-centroid layout arranges matched devices (like current-mirror transistors or differential pairs) such that any gradient across the die affects each device in the same way. Placing device segments in an interleaved pattern (e.g., &quot;ABBAABBA&quot; or similar) ensures that if there is a continuous gradient from left to right, each transistor or unit gets an equal piece of that gradient. This dramatically reduces offset due to wafer-level or chip-level process gradients.</p><img src="/tvip-analog-workspace/assets/common_centroid_arrays.C4UTvYmU.png" alt="common centroid arrays" width="600px"><p>Image from <a href="./resources/Maloberti_Layout_of_Analog_CMOS_ICs.pdf">F. Maloberti, &quot;Layout of Analog CMOS Integrated Circuits&quot; (Part 2)</a>.</p><p>In simpler interdigitated layouts, two transistors (A and B) are arranged as alternating fingers on the same row (A-B-A-B, etc.). This approach promotes symmetrical surroundings, though it may be less effective for large spatial gradients than full common-centroid patterns.</p><h4 id="interdigitation-patterns" tabindex="-1">Interdigitation Patterns <a class="header-anchor" href="#interdigitation-patterns" aria-label="Permalink to &quot;Interdigitation Patterns&quot;">​</a></h4><p>Basic interdigitation patterns used - these balance process gradients and improve matching.</p><table tabindex="0"><thead><tr><th>Number of Cells</th><th>1D Patterns</th><th>2D Patterns</th><th>3D Patterns</th><th>4D Patterns</th></tr></thead><tbody><tr><td>A (single device)</td><td>A</td><td>AA</td><td>AAA</td><td>AAAA</td></tr><tr><td>AB (two devices)</td><td>AB*</td><td>ABBA</td><td>ABBAAB*</td><td>ABABBABA</td></tr><tr><td>ABC (three devices)</td><td>ABC*</td><td>ABCCBA</td><td>ABCBACBCA*</td><td>ABCABCCBACBA</td></tr><tr><td>ABCD (four devices)</td><td>ABCD*</td><td>ABCDDCBA</td><td>ABCBCADBCDA*</td><td>ABCDDCBAABCDDCBA</td></tr><tr><td>ABA (ratio 2:1)</td><td>ABA</td><td>ABAABA</td><td>ABAABAABA</td><td>ABAABAABAABA</td></tr><tr><td>ABABA (ratio 3:2)</td><td>ABABA</td><td>ABABAABABA</td><td>ABABAABABAABABA</td><td>ABABAABABAABABAABABA</td></tr><tr><td>AABA (ratio 3:1)</td><td>AABA*</td><td>AABAABAA</td><td>AABAAABAAABA*</td><td>AABAABAAAABAABAA</td></tr><tr><td>AABAA (ratio 4:1)</td><td>AABAA</td><td>AABAAAABAA</td><td>AABAAAABAAAABAA</td><td>AABAAAABAAAABAAAABAA</td></tr></tbody></table><p>Note: Patterns marked with * may not permit a stacked layout due to connectivity constraints.</p><h4 id="common-centroid-layout-patterns" tabindex="-1">Common-centroid layout patterns <a class="header-anchor" href="#common-centroid-layout-patterns" aria-label="Permalink to &quot;Common-centroid layout patterns&quot;">​</a></h4><p>Below are several common centroid patterns used, with each letter representing a unit cell of a particular device (e.g., A and B might be the two transistors in a differential pair).</p><table tabindex="0"><thead><tr><th>Pattern Name</th><th>Visual Representation</th><th>Description</th><th>Best For</th></tr></thead><tbody><tr><td>Simple Interdigitated</td><td><code>ABABABAB</code></td><td>Basic finger interleaving in a single row</td><td>Simple current mirrors, small differential pairs</td></tr><tr><td>Cross-Coupled</td><td><code>ABBA</code><br><code>BAAB</code></td><td>2×2 array with diagonal symmetry</td><td>Differential pairs with moderate matching requirements</td></tr><tr><td>2×4 Common-Centroid</td><td><code>ABBAABBA</code><br><code>BAABBAAB</code></td><td>Larger array with better gradient cancellation</td><td>High-precision op-amp input stages</td></tr><tr><td>Checkerboard</td><td><code>ABABAB</code><br><code>BABABA</code><br><code>ABABAB</code></td><td>Alternating pattern in both dimensions</td><td>Quad devices (e.g., fully-differential circuits)</td></tr><tr><td>3-Device Common-Centroid</td><td><code>ABCCBA</code><br><code>CBAABC</code></td><td>Pattern for three matched devices</td><td>Triple current mirrors, 3-input comparators</td></tr><tr><td>Asymmetric Ratio</td><td><code>AABBAA</code><br><code>BAAAAB</code></td><td>For intentional device ratios (e.g., 4:2)</td><td>DACs, gain stages with specific ratios</td></tr></tbody></table><h3 id="symmetry-and-unit-cells" tabindex="-1">Symmetry and unit cells <a class="header-anchor" href="#symmetry-and-unit-cells" aria-label="Permalink to &quot;Symmetry and unit cells&quot;">​</a></h3><p>Well-designed analog blocks exploit symmetry to reduce mismatches. For instance, in differential pairs or current mirrors, each transistor is laid out with identical orientation, guard rings, and spacing to body contacts.</p><img src="/tvip-analog-workspace/assets/mirror_matching.BkH7NeGM.png" alt="mirror matching" width="800px"><p>When possible, repeated devices should be grouped into consistent &quot;unit cells&quot; with carefully replicated surroundings. This helps ensure each sub-device experiences the same environment for doping, stress, and parasitic effects.</p><h3 id="current-mirrors-and-differential-pairs" tabindex="-1">Current mirrors and differential pairs <a class="header-anchor" href="#current-mirrors-and-differential-pairs" aria-label="Permalink to &quot;Current mirrors and differential pairs&quot;">​</a></h3><p>When matching is critical (e.g., in a current mirror or the input pair of an op amp), it is common to:</p><ul><li>Split each transistor into multiple identical fingers rather than using a single large finger.</li><li>Interleave the fingers of matched transistors.</li><li>Route signals symmetrically to reduce IR drops and parasitic mismatches on either branch.</li><li>Share junctions (e.g., stacking source/drain diffusions) when transistors are series-connected, such as in cascode or stacked current sources.</li></ul><p>Ensuring the routing path to each transistor is the same length and has the same number of vias helps maintain symmetrical resistance and capacitance, which is particularly important for high-gain, high-precision circuits.</p><h3 id="passives" tabindex="-1">Passives <a class="header-anchor" href="#passives" aria-label="Permalink to &quot;Passives&quot;">​</a></h3><h4 id="capacitors" tabindex="-1">Capacitors <a class="header-anchor" href="#capacitors" aria-label="Permalink to &quot;Capacitors&quot;">​</a></h4><p>Accurate capacitor ratios are often vital in sample-and-hold circuits, filters, and DAC/ADC networks. Common capacitor structures in CMOS include:</p><ul><li><p>MOS capacitor (poly gate over substrate), which can be large and non-linear but useful for bypass or Miller compensation.</p></li><li><p>MOM capacitors (metal-oxide-metal) also called Metal Finger Capacitors (MFCs), which leverage lateral coupling in multiple metal layers for relatively high density without extra process steps.</p></li></ul><img src="/tvip-analog-workspace/assets/mfc_capacitors.SNRxFCAT.png" alt="mfc capacitors" width="600px"><p>For good matching, designers frequently use &quot;unit capacitors&quot; arranged in a common-centroid pattern, similar to matched transistors.</p><h4 id="resistors" tabindex="-1">Resistors <a class="header-anchor" href="#resistors" aria-label="Permalink to &quot;Resistors&quot;">​</a></h4><img src="/tvip-analog-workspace/assets/matched_resistors.CFmqwbBn.png" alt="matched resistors" width="800px"><p>Image from <a href="./Lienig_Fundamentals_of_Layout_Design_for_Electronic_Circuits.pdf">Lienig, Scheible, &quot;Fundamentals of Layout Design for Electronic Circuits,&quot; Springer 2020</a>.</p><p>Standard CMOS processes typically prioritize transistors and interconnect, so pure resistors can be somewhat ad hoc. Designers often use:</p><ul><li><p><strong>Diffusion or poly resistors</strong> which are simple to implement but can have high temperature or voltage coefficients.</p></li><li><p><strong>Silicide-blocked regions</strong> which increase the sheet resistance of diffusion or poly for larger resistor values.</p></li></ul><p>Like transistors, resistors that must match or maintain a precise ratio are laid out in unit segments, repeated and placed in symmetrical arrays. Contacts and corners are carefully managed to reduce systematic mismatch. Keep in mind that absolute resistor accuracy is typically much worse than relative matching, so ratio-based designs (like feedback networks) are easier to optimize than designs requiring a precise absolute resistance.</p><h2 id="ir-drop" tabindex="-1">IR Drop <a class="header-anchor" href="#ir-drop" aria-label="Permalink to &quot;IR Drop&quot;">​</a></h2><p>IR drop <strong>CANNOT BE IGNORED</strong> in modern nodes, particularly when wide metal lines are not used for power/ground or high-current paths.</p><p>Narrow metals and too few vias can introduce tens of ohms of parasitic resistance, which can skew bias voltages and degrade matching.</p><p>Always consider adding more metal width and multiple vias to keep IR drops minimal and symmetrical.</p><img src="/tvip-analog-workspace/assets/ir_drop_gate_resistance.BI9s6QLi.png" alt="ir drop gate resistance" width="600px"><p>Image from <a href="./resources/Maloberti_Layout_of_Analog_CMOS_ICs.pdf">F. Maloberti, &quot;Layout of Analog CMOS Integrated Circuits&quot; (Part 2)</a>.</p><h3 id="matching-ir-drop" tabindex="-1">Matching IR drop <a class="header-anchor" href="#matching-ir-drop" aria-label="Permalink to &quot;Matching IR drop&quot;">​</a></h3><img src="/tvip-analog-workspace/assets/matching_connections.TqxC3DbX.png" alt="matching connections" width="600px"><p>Image from <a href="./Lienig_Fundamentals_of_Layout_Design_for_Electronic_Circuits.pdf">Lienig, Scheible, &quot;Fundamentals of Layout Design for Electronic Circuits,&quot; Springer 2020</a>.</p></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><!----></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/tvip-analog-workspace/Power_Grids.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>Power Grids</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-5d98c3a5 data-v-e315a0ad><div class="container" data-v-e315a0ad><p class="message" data-v-e315a0ad>Released under the <a href="https://github.com/neu-ucb-tvip/tvip-analog-workspace/blob/main/LICENSE">BSD-3-Clause License</a>.</p><p class="copyright" data-v-e315a0ad>Copyright © 2025-present, The Regents of the University of California (Regents). All Rights Reserved.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"analog_layout_guide.md\":\"MfPhWJ-m\",\"index.md\":\"CM4QdG1R\",\"power_grids.md\":\"B7DHwAiY\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"TVIP Analog Workspace\",\"description\":\"Analog Design Workspace for Sky130 PDK\",\"base\":\"/tvip-analog-workspace/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Analog Layout Guide\",\"link\":\"/Analog_Layout_Guide\"},{\"text\":\"Power Grids\",\"link\":\"/Power_Grids\"}],\"sidebar\":[{\"text\":\"Documentation\",\"items\":[{\"text\":\"Analog Layout Guide\",\"link\":\"/Analog_Layout_Guide\"},{\"text\":\"Power Grids\",\"link\":\"/Power_Grids\"}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/neu-ucb-tvip/tvip-analog-workspace\"}],\"search\":{\"provider\":\"local\"},\"footer\":{\"message\":\"Released under the <a href=\\\"https://github.com/neu-ucb-tvip/tvip-analog-workspace/blob/main/LICENSE\\\">BSD-3-Clause License</a>.\",\"copyright\":\"Copyright © 2025-present, The Regents of the University of California (Regents). All Rights Reserved.\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>